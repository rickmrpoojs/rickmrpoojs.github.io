<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width,
       initial-scale=1.0">
    <title>Promise.all</title>
  </head>
  <body>
    <h1>Promise.all</h1>
    <p>
      <button
        onclick="ejecuta();">
        Ejecuta
      </button>
    </p>
    <footer>
      <p>
        &copy; 2021
        Ricardo Armando Machorro Reyes
      </p>
    </footer>
    <script>
      function
        prom(resultado, timeout) {
        return new Promise(
          (resolve, reject) =>
            setTimeout(() => {
              if (resultado) {
                resolve(
                  "Éxito[" +
                  resultado +
                  "]");
              } else {
                reject(new Error(
                  "Falla[" +
                  resultado +
                  "]"));
              }
            },
              timeout));
      }
      async function ejecuta() {
        try {
          const r1 =
            await Promise.all(
              [prom("a", 300),
              prom("z", 2000),
              prom("b", 5000)]);
          alert("Éxito 1: " +
            r1.join());
        } catch (e) {
          alert("Falló 1: " +
            e.message);
        }
        try {
          const r2 =
            await Promise.all(
              [prom("a", 100),
              prom("", 1000),
              prom("b", 5000)]);
          alert(`Éxito 2: ${r2}`);
        } catch (e) {
          alert("Falló 2: " +
            e.message);
        }
      }
    </script>
  </body>
</html>